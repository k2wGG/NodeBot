{# templates/discord_announcements.html #}
{% extends 'base.html' %}

{% block title %}Discord-–ê–Ω–æ–Ω—Å—ã{% endblock %}

{% block content %}
  <div class="container mt-4">
    <h1>–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∞–Ω–æ–Ω—Å—ã –∏–∑ Discord</h1>
    <table class="table table-bordered table-hover">
      <thead class="table-light">
        <tr>
          <th>ID</th>
          <th>–ö–∞–Ω–∞–ª (Discord)</th>
          <th>Telegram User</th>
          <th>–°–æ–¥–µ—Ä–∂–∏–º–æ–µ</th>
          <th>–î–∞—Ç–∞</th>
          <th>–ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ</th>
          <th>–î–µ–π—Å—Ç–≤–∏—è</th>
        </tr>
      </thead>
      <tbody>
        {% for a in announcements %}
          <tr>
            <td>{{ a.id }}</td>
            <td>
              {{ channels[a.channel_id].channel_name or channels[a.channel_id].channel_id }}
            </td>
            <td>{{ users[a.user_id].username or users[a.user_id].telegram_id }}</td>
            <td style="max-width:300px; word-wrap:break-word;">
              {{ a.translated or a.content }}
            </td>
            <td>{{ a.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
            <td>{{ a.matched_filter or '‚Äî' }}</td>
            <td>
              <form action="{{ url_for('delete_discord_announcement', ann_id=a.id) }}"
                    method="post"
                    style="display:inline-block;"
                    onsubmit='return confirm("–£–¥–∞–ª–∏—Ç—å –∞–Ω–æ–Ω—Å ID {{ a.id }}?");'>
                <button type="submit" class="btn btn-sm btn-danger">
                  üóë –£–¥–∞–ª–∏—Ç—å
                </button>
              </form>
            </td>
          </tr>
        {% else %}
          <tr>
            <td colspan="7" class="text-center">–ù–µ—Ç –∞–Ω–æ–Ω—Å–æ–≤.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}
